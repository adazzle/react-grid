<!doctype html>
<html data-reactid=".1wmi04i29s" data-react-checksum="1495961464"><head data-reactid=".1wmi04i29s.0"><title data-reactid=".1wmi04i29s.0.0">React Grid</title><link rel="stylesheet" href="&#x2f;react-grid&#x2f;styles&#x2f;index.css" data-reactid=".1wmi04i29s.0.1"></head><body title="React Grid" data-reactid=".1wmi04i29s.1"><nav class="NavigationBar navbar navbar-default navbar-fixed-top" role="navigation" data-reactid=".1wmi04i29s.1.0"><div class="container-fluid" data-reactid=".1wmi04i29s.1.0.0"><div class="navbar-header" data-reactid=".1wmi04i29s.1.0.0.0"><a class="navbar-brand" href="&#x2f;react-grid&#x2f;" data-reactid=".1wmi04i29s.1.0.0.0.0">React Grid</a></div><div class="collapse navbar-collapse" data-reactid=".1wmi04i29s.1.0.0.1"><ul class="nav navbar-nav" data-reactid=".1wmi04i29s.1.0.0.1.0"><li data-reactid=".1wmi04i29s.1.0.0.1.0.$documentation&#x2f;"><a href="&#x2f;react-grid&#x2f;documentation&#x2f;" data-reactid=".1wmi04i29s.1.0.0.1.0.$documentation&#x2f;.0">Documentation</a></li><li class="dropdown" data-reactid=".1wmi04i29s.1.0.0.1.0.$1"><a class="dropdown-toggle" data-reactid=".1wmi04i29s.1.0.0.1.0.$1.0"><span data-reactid=".1wmi04i29s.1.0.0.1.0.$1.0.0">Examples</span><span data-reactid=".1wmi04i29s.1.0.0.1.0.$1.0.1"> </span><b class="caret" data-reactid=".1wmi04i29s.1.0.0.1.0.$1.0.2"></b></a><ul class="dropdown-menu" data-reactid=".1wmi04i29s.1.0.0.1.0.$1.1"><li data-reactid=".1wmi04i29s.1.0.0.1.0.$1.1.$undefined__examples&#x2f;resizeable-columns=1html"><a href="&#x2f;react-grid&#x2f;examples&#x2f;resizeable-columns.html" data-reactid=".1wmi04i29s.1.0.0.1.0.$1.1.$undefined__examples&#x2f;resizeable-columns=1html.0">Resizeable columns</a></li><li data-reactid=".1wmi04i29s.1.0.0.1.0.$1.1.$undefined__examples&#x2f;locked-columns=1html"><a href="&#x2f;react-grid&#x2f;examples&#x2f;locked-columns.html" data-reactid=".1wmi04i29s.1.0.0.1.0.$1.1.$undefined__examples&#x2f;locked-columns=1html.0">Locked columns</a></li><li data-reactid=".1wmi04i29s.1.0.0.1.0.$1.1.$undefined__examples&#x2f;custom-renderers=1html"><a href="&#x2f;react-grid&#x2f;examples&#x2f;custom-renderers.html" data-reactid=".1wmi04i29s.1.0.0.1.0.$1.1.$undefined__examples&#x2f;custom-renderers=1html.0">Custom renderers</a></li><li data-reactid=".1wmi04i29s.1.0.0.1.0.$1.1.$undefined__examples&#x2f;sortable-grid=1html"><a href="&#x2f;react-grid&#x2f;examples&#x2f;sortable-grid.html" data-reactid=".1wmi04i29s.1.0.0.1.0.$1.1.$undefined__examples&#x2f;sortable-grid=1html.0">Implementing sortable grid</a></li><li data-reactid=".1wmi04i29s.1.0.0.1.0.$1.1.$undefined__examples&#x2f;datagrid=1html"><a href="&#x2f;react-grid&#x2f;examples&#x2f;datagrid.html" data-reactid=".1wmi04i29s.1.0.0.1.0.$1.1.$undefined__examples&#x2f;datagrid=1html.0">Implementing lazy-loading datagrid</a></li></ul></li></ul><div class="navbar-repo" data-reactid=".1wmi04i29s.1.0.0.1.1"><a href="https:&#x2f;&#x2f;github.com&#x2f;prometheusresearch&#x2f;react-grid" data-reactid=".1wmi04i29s.1.0.0.1.1.0"><span data-reactid=".1wmi04i29s.1.0.0.1.1.0.0">React Grid</span><span data-reactid=".1wmi04i29s.1.0.0.1.1.0.1"> on GitHub →</span></a></div></div></div></nav><div class="wrapper" data-reactid=".1wmi04i29s.1.1"><div class="ExampleDownload container" data-reactid=".1wmi04i29s.1.1.0"><a href="https:&#x2f;&#x2f;github.com&#x2f;prometheusresearch&#x2f;react-grid&#x2f;blob&#x2f;master&#x2f;docs&#x2f;contents&#x2f;scripts&#x2f;examples&#x2f;sortable-grid.jsx" data-reactid=".1wmi04i29s.1.1.0.0">See example code</a></div><div class="Content container" data-reactid=".1wmi04i29s.1.1.1"><h1 id="implementing-sortable-grid">Implementing sortable grid</h1>
<p>This demo shows how to implement sortable columns behaviour on top of a base
<code>Grid</code> component. In fact, one can implement the functionality in just under
100LOC.</p>
<h2 id="header-cell-renderer-with-sortable-button">Header cell renderer with sortable button</h2>
<p>First thing we need is to implement a custom header cell renderer
which would show active sort column and direction.</p>
<pre><code>var SortableHeaderCell = React.createClass({
</code></pre><p>Column specification for a sortable column would have an additional attribute
<code>sorted</code> which can be <code>undefined</code> or one of <code>&quot;asc&quot;</code> or <code>&quot;desc&quot;</code> correspondingly
for asceding and descending sort orders.</p>
<p>We can use to show a corresponding icon near the column name. We also setup a
<code>onClick</code> handler.</p>
<pre><code>  render: function() {
    var sorted = this.props.column.sorted

    var icon = sorted ?
      (sorted === &#39;asc&#39; ?  &#39;↓&#39; : &#39;↑&#39;) :
      null

    return (
      &lt;div onClick={this.onClick}&gt;
        {this.props.column.name}
        &lt;span&gt;{icon}&lt;/span&gt;
      &lt;/div&gt;
    )

  }
</code></pre><p>Column specification would have a callback <code>sortBy</code> which would be called when
user clicks on a column header so the grid component can be notified of the
user&#39;s intent to sort the data by specified column in the specified order.</p>
<pre><code>  onClick: function() {
    var sorted = this.props.column.sorted;
    sorted = sorted === &#39;asc&#39; ?
      &#39;desc&#39; : &#39;asc&#39;;
    this.props.column.sortBy(
      this.props.column,
      sorted)
  }
</code></pre><h2 id="sortablegrid-implementation">SortableGrid implementation</h2>
<p>Now we provide the <code>SortableGrid</code> component which wraps the original <code>Grid</code>
component to decorate column headers and to provide data source with sort
column and sort direction information.</p>
<pre><code>var SortableGrid = React.createClass({
</code></pre><p>The <code>SortableGrid</code> controls by which column and in what direction data is
sorted when it&#39;s shown. For that reason we need this component to store
currently active column and direction in state.</p>
<pre><code>  getInitialState: function() {
    return {
      sortDirection: null,
      sortColumn: null
    }
  }
</code></pre><p>The <code>render()</code> method just decorates column specification with needed
information for proper column rendering and provides a rows data source.</p>
<pre><code>  render: function() {
    var columns = this.getDecoratedColumns(
      this.props.columns);
    return this.transferPropsTo(
      &lt;Grid
        columns={columns}
        rows={this.rows} /&gt;
    );
  }
</code></pre><p>This is the method which decorates original column specification.</p>
<p>It checks if user passed <code>sortable</code> property for a column and sets up the
<code>SortableHeaderCell</code> renrderer for such columns.</p>
<p>It also sets up <code>sorted</code> attribute which reflects the current state of the
<code>SortableGrid</code>.</p>
<p>The last piece is to provide a callback <code>sortBy</code> which would be called by
<code>SortableHeaderCell</code> when user wants to change sort column and sort direction.</p>
<pre><code>  getDecoratedColumns: function(columns) {
    return this.props.columns.map((column) =&gt; {
      column = shallowCloneObject(column)
      if (column.sortable) {
        column.headerRenderer = SortableHeaderCell
        column.sortBy = this.sortBy
        if (this.state.sortColumn === column.id) {
          column.sorted = this.state.sortDirection
        }
      }
      return column
    })
  }
</code></pre><p>The method <code>sortBy(column, direction)</code> gets called when user clicks on a column
header of a sortable column. This makes <code>SortableGrid</code> update its state with
new <code>sortColumn</code> and <code>sortDirection</code> values.</p>
<pre><code>  sortBy: function(column, direction) {
    this.setState({
      sortColumn: column.id,
      sortDirection: direction
    });
  }
</code></pre><p>Now the <code>rows(start, end)</code> method just delegates all the work to underlying
data source passed via <code>props</code>, by providing it with additional information
related to sorting.</p>
<p>Developer can user this information to construct a query to API which includes
needed sort column and sort direction.</p>
<pre><code>  rows: function(start, end) {
    return this.props.rows(
        start, end,
        this.props.length,
        this.state.sortColumn,
        this.state.sortDirection)
  }
</code></pre><h2 id="sortable-grid-in-action">Sortable grid in action</h2>
<p>We simply define the column specification:</p>
<pre><code>var columns = [
  {
    id: &#39;num&#39;,
    name: &#39;№&#39;,
    width: &#39;20%&#39;,
    key: 0,
    sortable: true
  },
  {
    id: &#39;name&#39;,
    name: &#39;Name&#39;,
    width: &#39;30%&#39;,
    key: 1,
    sortable: true
  },
  ...
]
</code></pre><p>And use it to create a <code>SortableGrid</code> component:</p>
<pre><code>&lt;SortableGrid
  columns={columns}
  length={100000}
  rows={rows}
  rowHeight={40}
  /&gt;
</code></pre><div id="example"></div>
</div></div><script src="&#x2f;react-grid&#x2f;scripts&#x2f;react.js" data-reactid=".1wmi04i29s.1.2"></script><script src="&#x2f;react-grid&#x2f;scripts&#x2f;react-grid.js" data-reactid=".1wmi04i29s.1.3"></script><script src="&#x2f;react-grid&#x2f;scripts&#x2f;ShowValue.js" data-reactid=".1wmi04i29s.1.4:$0"></script><script src="&#x2f;react-grid&#x2f;scripts&#x2f;examples&#x2f;sortable-grid.js" data-reactid=".1wmi04i29s.1.4:$1"></script></body></html>